# Setting Up a Customized Page

This guide covers how to create a custom theme with your own templates and styles. It explains the structure of the `page` folder in depth.

**Prerequisites:** Read [Getting Started](01.getting-started.md) first.

---

## Table of Contents

1. [Page Folder Structure](#page-folder-structure)
2. [Configuration Deep Dive](#configuration-deep-dive)
3. [Creating a Custom Theme](#creating-a-custom-theme)
4. [Template Reference](#template-reference)
5. [Styling Your Theme](#styling-your-theme)
6. [Menu System](#menu-system)
7. [Assets Management](#assets-management)

---

## Page Folder Structure

```
page/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ config.php              # Main configuration file
â”œâ”€â”€ content/
â”‚   â”œâ”€â”€ pages/                  # Static pages (about.md, contact.md, etc.)
â”‚   â”œâ”€â”€ posts/                  # Blog posts
â”‚   â”œâ”€â”€ snippets/               # Reusable content blocks for tag pages
â”‚   â””â”€â”€ img/                    # Media files (copied to dist/img/)
â””â”€â”€ views/
    â””â”€â”€ [theme-name]/           # Your theme folder
        â”œâ”€â”€ assets/             # Static assets
        â”‚   â”œâ”€â”€ css/            # Stylesheets
        â”‚   â”œâ”€â”€ js/             # JavaScript files
        â”‚   â””â”€â”€ tpl-img/        # Template images (icons, etc.)
        â”œâ”€â”€ menus/              # Menu templates
        â”‚   â”œâ”€â”€ main.phtml
        â”‚   â”œâ”€â”€ footer.phtml
        â”‚   â””â”€â”€ social.phtml
        â”œâ”€â”€ partials/           # Reusable template parts
        â”‚   â”œâ”€â”€ head.phtml
        â”‚   â”œâ”€â”€ head-index.phtml
        â”‚   â”œâ”€â”€ header.phtml
        â”‚   â”œâ”€â”€ footer.phtml
        â”‚   â”œâ”€â”€ article.phtml
        â”‚   â””â”€â”€ page-content.phtml
        â”œâ”€â”€ page.phtml          # Single page layout
        â”œâ”€â”€ post.phtml          # Single blog post layout
        â”œâ”€â”€ index.phtml         # Blog post list layout
        â”œâ”€â”€ tag.phtml           # Tag archive layout
        â””â”€â”€ homepage.phtml      # Optional custom homepage template
```

---

## Configuration Deep Dive

The `config/config.php` file is a PHP array that defines all site-wide settings. Here's a complete reference:

```php
<?php
return json_decode(json_encode([
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // BASIC SETTINGS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // Theme name â€“ must match a folder in views/
    "theme" => "default",

    // Base URL for your site (used for absolute links, RSS, sitemap)
    // Leave empty "" for relative URLs (good for local testing)
    "base_url" => "https://example.com",

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SITE METADATA
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // Main title (appears in header, browser tab, RSS)
    "title" => "My Awesome Site",

    // Short tagline/slogan (appears below title in header)
    "tagline" => "Thoughts on code and creativity",

    // SEO description (used in meta tags and RSS)
    "description" => "A personal blog about web development...",

    // HTML lang attribute (en-US, de-DE, fr-FR, etc.)
    "language" => "en-US",

    // Default author (used when content doesn't specify one)
    "author" => "Your Name",

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // URL STRUCTURE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    "slugs" => [
        // Blog index filename:
        // - "index" â†’ blog on homepage (yoursite.com/index.html)
        // - "blog"  â†’ separate blog page (yoursite.com/blog.html)
        "post_index" => "blog",

        // RSS feed filename (yoursite.com/feed.xml)
        "feed" => "feed",
    ],

    // Tag pages URL prefix (yoursite.com/tags/javascript.html)
    "tag_path" => "tags",

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // NAVIGATION MENUS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    "menus" => [
        // Main navigation
        "main" => [
            ["internal" => "index", "label" => "Home"],
            ["internal" => "blog", "label" => "Blog"],
            ["internal" => "about", "label" => "About"],
        ],

        // Footer links
        "footer" => [
            ["internal" => "imprint", "label" => "Imprint"],
            ["internal" => "privacy-policy", "label" => "Privacy Policy"],
        ],

        // Social/external links
        "social" => [
            ["external" => "https://github.com/yourusername", "label" => "GitHub"],
            ["external" => "https://twitter.com/yourusername", "label" => "Twitter"],
            ["internal" => "feed", "label" => "RSS", "type" => "feed"],
        ],
    ],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // FOLDER PATHS (usually no changes needed)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    "folders" => [
        "assets" => "assets",
        "dist" => __DIR__ . "/../../dist",
        "dist_tags" => __DIR__ . "/../../dist/tags",
        "content_images" => __DIR__ . "/../../page/content/img",
        "dist_content_images" => __DIR__ . "/../../dist/img",
        "views" => __DIR__ . "/../views/",
        "content" => __DIR__ . "/../content/",
    ],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // VIEW MAPPING (usually no changes needed)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    "views" => [
        "post" => "post.phtml",
        "post_index" => "index.phtml",
        "page" => "page.phtml",
        "tag" => "tag.phtml",
        "menus" => [
            "main" => "menus/main.phtml",
            "footer" => "menus/footer.phtml",
            "social" => "menus/social.phtml",
        ],
    ],

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CONTENT PATHS (usually no changes needed)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    "content" => [
        "posts" => "posts",
        "pages" => "pages",
        "snippets" => "snippets",
    ],

    // File extensions for generated files
    "file_extension_content" => "html",
    "file_extension_feed" => "xml",

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CUSTOM SETTINGS (add your own!)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // You can add any custom keys â€“ they'll be available in templates
    // as $config->your_key
    "analytics_id" => "UA-XXXXX-Y",
    "copyright_year" => "2025",
]));
```

### Environment-Specific Configs

You can create multiple config files for different environments:

```
config/
â”œâ”€â”€ config.php           # Production config (used by default)
â”œâ”€â”€ local-config.php     # Local development
â””â”€â”€ preview-config.php   # Staging/preview environment
```

Before building, swap configs:
```shell
cp config/preview-config.php config/config.php
```

---

## Creating a Custom Theme

### Step 1: Copy the Default Theme

```shell
cd page/views
cp -r default mytheme
```

### Step 2: Update Config

```php
"theme" => "mytheme",
```

### Step 3: Customize Templates

Now you can modify any template in `views/mytheme/` without affecting the original.

---

## Template Reference

Templates are PHP files (`.phtml`) that receive variables from the engine. Here's what's available:

### Available Variables

| Variable | Type | Available In | Description |
|----------|------|--------------|-------------|
| `$config` | object | All templates | Site configuration (all keys from config.php) |
| `$entity` | Entity | Single content | The current page/post being rendered |
| `$entities` | array | Index templates | Array of posts for list views |
| `$generatedMenus` | array | Layout templates | Pre-rendered menu HTML |
| `$slug` | string | Index templates | Current page slug |
| `$snippet` | Entity\|null | Tag templates | Optional tag description content |
| `$displayExcerpt` | bool | Article partial | Whether to show excerpt or full content |

### Entity Methods

When working with `$entity` (a Page or Post):

```php
// Get any frontmatter value
$entity->get('title')        // string
$entity->get('status')       // string: 'published' or 'draft'
$entity->get('created_at')   // DateTime object
$entity->get('content')      // string: rendered HTML content
$entity->get('author')       // string|null
$entity->get('image')        // string|null: image filename
$entity->get('tags')         // array|null: tag names (posts only)
$entity->get('description')  // string|null: custom meta description
$entity->get('template')     // string|null: custom template filename

// Get the URL slug
$entity->getSlug()                    // "/my-post-title"
$entity->getSlug($config->base_url)   // "https://example.com/my-post-title"

// Posts only: get excerpt (first 3 paragraphs)
$entity->getExcerpt()
```

### Template Examples

#### Layout Template (page.phtml)

```php
<!DOCTYPE html>
<html lang="<?= $config->language ?>">
<head>
    <?php include __DIR__ . '/partials/head.phtml' ?>
</head>
<body>
    <?php include __DIR__ . '/partials/header.phtml' ?>

    <main>
        <?php include __DIR__ . '/partials/page-content.phtml' ?>
    </main>

    <?php include __DIR__ . '/partials/footer.phtml' ?>
</body>
</html>
```

#### Head Partial (partials/head.phtml)

```php
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title><?= $config->title ?> â€“ <?= $entity->get('title') ?? $config->tagline ?></title>
<meta name="description" content="<?= $entity->get('description') ?? $config->description ?>">

<!-- Canonical URL -->
<link rel="canonical" href="<?= $entity->getSlug($config->base_url) ?>.<?= $config->file_extension_content ?>">

<!-- Stylesheets -->
<link rel="stylesheet" href="<?= $config->base_url ?>/css/styles.css">

<!-- Open Graph -->
<meta property="og:title" content="<?= $entity->get('title') ?>">
<meta property="og:description" content="<?= $entity->get('description') ?? $config->description ?>">
<?php if ($entity->get('image')): ?>
<meta property="og:image" content="<?= $config->base_url ?>/img/<?= $entity->get('image') ?>">
<?php endif; ?>
```

#### Article Partial (partials/article.phtml)

```php
<article>
    <header>
        <time datetime="<?= $entity->get('created_at')->format('Y-m-d') ?>">
            <?= $entity->get('created_at')->format('F j, Y') ?>
        </time>
        <h1>
            <a href="<?= $entity->getSlug($config->base_url) ?>.<?= $config->file_extension_content ?>">
                <?= $entity->get('title') ?>
            </a>
        </h1>
    </header>

    <?php if ($entity->get('image')): ?>
    <figure>
        <img src="<?= $config->base_url ?>/img/<?= $entity->get('image') ?>"
             alt="<?= htmlentities($entity->get('title')) ?>"
             loading="lazy">
    </figure>
    <?php endif; ?>

    <div class="content">
        <?php if (isset($displayExcerpt) && $displayExcerpt): ?>
            <?= $entity->getExcerpt() ?>
            <a href="<?= $entity->getSlug($config->base_url) ?>.<?= $config->file_extension_content ?>" class="read-more">
                Continue reading â†’
            </a>
        <?php else: ?>
            <?= $entity->get('content') ?>
        <?php endif; ?>
    </div>

    <footer>
        <?php if ($entity->get('tags')): ?>
        <div class="tags">
            <?php foreach ($entity->get('tags') as $tag): ?>
            <a href="<?= $config->base_url ?>/<?= $config->tag_path ?>/<?= strtolower($tag) ?>.<?= $config->file_extension_content ?>">
                #<?= $tag ?>
            </a>
            <?php endforeach; ?>
        </div>
        <?php endif; ?>

        <span class="author">
            by <?= $entity->get('author') ?? $config->author ?>
        </span>
    </footer>
</article>
```

#### Index Template (index.phtml)

```php
<!DOCTYPE html>
<html lang="<?= $config->language ?>">
<head>
    <?php include __DIR__ . '/partials/head-index.phtml' ?>
</head>
<body>
    <?php include __DIR__ . '/partials/header.phtml' ?>

    <main>
        <h1>Latest Posts</h1>

        <?php
        $displayExcerpt = true;
        foreach ($entities as $entity):
            include __DIR__ . '/partials/article.phtml';
        endforeach;
        ?>
    </main>

    <?php include __DIR__ . '/partials/footer.phtml' ?>
</body>
</html>
```

### Custom Page Templates

You can use a custom template for specific pages by setting `template` in frontmatter:

```markdown
---
title: 'Homepage'
slug: 'index'
status: 'published'
created_at: '2025-01-02'
template: 'homepage.phtml'
---
```

Then create `views/[theme]/homepage.phtml` with your custom layout.

---

## Styling Your Theme

### CSS Structure

The default theme uses [new.css](https://newcss.net/), a classless CSS framework. Customizations go in `assets/css/new.theme.simpla.css`:

```css
:root {
    /* Typography */
    --nc-font-sans: 'Your Font', system-ui, sans-serif;
    --nc-font-mono: 'Fira Code', monospace;

    /* Light theme colors */
    --nc-tx-1: #000000;      /* Primary text */
    --nc-tx-2: #1A1A1A;      /* Secondary text */
    --nc-bg-1: #FFFFFF;      /* Primary background */
    --nc-bg-2: #F6F8FA;      /* Secondary background */
    --nc-bg-3: #E5E7EB;      /* Tertiary background */
    --nc-lk-1: #0070F3;      /* Link color */
    --nc-lk-2: #0366D6;      /* Link hover */
    --nc-ac-1: #79FFE1;      /* Accent color */

    /* Dark theme colors (for prefers-color-scheme: dark) */
    --nc-d-tx-1: #ffffff;
    --nc-d-tx-2: #eeeeee;
    --nc-d-bg-1: #000000;
    --nc-d-bg-2: #111111;
    --nc-d-bg-3: #222222;
    --nc-d-lk-1: #3291FF;
    --nc-d-lk-2: #0070F3;
    --nc-d-ac-1: #7928CA;
}

/* Custom styles */
.article-list {
    display: grid;
    gap: 2rem;
}

.read-more {
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.875rem;
}
```

### Using a Different CSS Framework

You're not limited to new.css. Update your head partial to use any framework:

```php
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Or your own CSS -->
<link rel="stylesheet" href="<?= $config->base_url ?>/css/custom.css">
```

### Code Highlighting

Simpla includes [highlight.js](https://highlightjs.org/) for syntax highlighting. The theme files are in `assets/css/styles/`. To change the theme:

1. Pick a theme from the `styles/` folder
2. Update your head partial:

```php
<link rel="stylesheet" href="<?= $config->base_url ?>/css/styles/dracula.css">
<script src="<?= $config->base_url ?>/js/highlight.pack.js"></script>
<script>hljs.highlightAll();</script>
```

---

## Menu System

### Defining Menus

Menus are defined in `config.php`:

```php
"menus" => [
    "main" => [
        // Internal link to a page
        ["internal" => "about", "label" => "About"],

        // Internal link with explicit type
        ["internal" => "blog", "label" => "Blog", "type" => "content"],

        // External link
        ["external" => "https://github.com/user", "label" => "GitHub"],

        // RSS feed link
        ["internal" => "feed", "label" => "RSS", "type" => "feed"],
    ],
    "footer" => [...],
    "social" => [...],
],
```

### Menu Item Types

| Key | Description | URL Generated |
|-----|-------------|---------------|
| `internal` | Page slug | `base_url/slug.html` |
| `external` | Full URL | Used as-is |
| `type: content` | HTML page (default) | `.html` extension |
| `type: feed` | Feed file | `.xml` extension |

### Menu Templates

Each menu needs a corresponding template in `views/[theme]/menus/`:

**menus/main.phtml:**
```php
<nav class="main-nav">
    <ul>
        <?php foreach ($menuItems as $item): ?>
        <li><?= $buildMenuLink($item) ?></li>
        <?php endforeach; ?>
    </ul>
</nav>
```

The `$buildMenuLink($item)` function generates the `<a>` tag with proper href and label.

**Custom menu rendering:**
```php
<nav class="social-nav">
    <?php foreach ($menuItems as $item): ?>
        <?php
        $href = $item->external ?? $config->base_url . '/' . $item->internal;
        $href .= isset($item->type) && $item->type === 'feed'
            ? '.' . $config->file_extension_feed
            : '.' . $config->file_extension_content;
        ?>
        <a href="<?= $href ?>" <?= isset($item->external) ? 'target="_blank" rel="noopener"' : '' ?>>
            <?= $item->label ?>
        </a>
    <?php endforeach; ?>
</nav>
```

### Using Menus in Templates

Menus are pre-rendered and available via `$generatedMenus`:

```php
<!-- In header.phtml -->
<header>
    <?= $generatedMenus['main'] ?>
    <h1><?= $config->title ?></h1>
</header>

<!-- In footer.phtml -->
<footer>
    <?= $generatedMenus['footer'] ?>
    <?= $generatedMenus['social'] ?>
</footer>
```

---

## Assets Management

### Static Assets

Files in `views/[theme]/assets/` are copied to `dist/` during build:

```
views/mytheme/assets/
â”œâ”€â”€ css/
â”‚   â””â”€â”€ styles.css      â†’ dist/css/styles.css
â”œâ”€â”€ js/
â”‚   â””â”€â”€ main.js         â†’ dist/js/main.js
â””â”€â”€ tpl-img/
    â””â”€â”€ logo.svg        â†’ dist/tpl-img/logo.svg
```

### Content Images

Images in `content/img/` are copied to `dist/img/`:

```
content/img/
â”œâ”€â”€ photo.jpg           â†’ dist/img/photo.jpg
â””â”€â”€ diagram.png         â†’ dist/img/diagram.png
```

Reference them in content:

```markdown
![My photo](/img/photo.jpg)
```

Or in templates:

```php
<img src="<?= $config->base_url ?>/img/<?= $entity->get('image') ?>">
```

### External Assets (CDN)

For production, you might prefer CDN-hosted assets:

```php
<!-- In head.phtml -->
<?php if ($config->base_url): ?>
    <!-- Production: use CDN -->
    <link rel="stylesheet" href="https://cdn.example.com/styles.css">
<?php else: ?>
    <!-- Local: use local files -->
    <link rel="stylesheet" href="/css/styles.css">
<?php endif; ?>
```

---

## Next Steps

âœï¸ **Write Content** â†’ [Creating Content](03.creating-content.md)

ğŸš€ **Deploy Automatically** â†’ [GitHub Actions Deployment](04.github-actions-deployment.md)
